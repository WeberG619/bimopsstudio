<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Products | BIM Ops Studio</title>
  <meta name="description" content="Revit automation products in development at BIM Ops Studio." />
  <meta name="robots" content="index,follow" />
  <meta property="og:title" content="Products | BIM Ops Studio" />
  <meta property="og:description" content="Revit automation products in development at BIM Ops Studio." />
  <meta property="og:type" content="website" />
  <meta property="og:url" content="https://www.bimopsstudio.com/" />
  <meta name="theme-color" content="#0f172a" />
  <link rel="icon" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 256 256'%3E%3Crect width='256' height='256' rx='56' fill='%230f172a'/%3E%3Cpath fill='%23fff' d='M64 168V88a16 16 0 0 1 16-16h64a40 40 0 0 1 0 80H96v16zm32-48h48a16 16 0 0 0 0-32H96zM96 168h48a16 16 0 0 0 0-32H96z'/%3E%3C/svg%3E" />
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    .glass{backdrop-filter:saturate(180%) blur(10px); background:rgba(15,23,42,.55)}
    .shadow-soft{box-shadow:0 10px 30px rgba(2,6,23,.25)}
    .container{max-width:1100px}
    a.active{color:white; font-weight:600; text-decoration:underline; text-underline-offset:6px}
  </style>
</head>
<body class="bg-slate-950 text-slate-100 antialiased">

  <header class="sticky top-0 z-50 bg-slate-950/80 glass">
    <div class="container mx-auto px-4 py-4 flex items-center justify-between">
      <a href="index.html" class="flex items-center gap-2 font-semibold tracking-tight text-slate-50">
        <span class="inline-flex h-8 w-8 items-center justify-center rounded-xl bg-sky-500 text-slate-950 font-bold">B</span>
        <span>BIM Ops Studio</span>
      </a>
      <nav class="hidden md:flex items-center gap-6 text-sm text-slate-300">
        <a href="index.html" class="hover:text-white">Home</a>
        <a href="products.html" class="hover:text-white active">Products</a>
        <a href="roadmap.html" class="hover:text-white">Roadmap</a>
        <a href="projects.html" class="hover:text-white">Projects</a>
        <a href="adn.html" class="hover:text-white">For ADN Reviewers</a>
        <a href="about.html" class="hover:text-white">About</a>
        <a href="contact.html" class="hover:text-white">Contact</a>
        <a href="mailto:weber@bimopsstudio.com?subject=ReviTask%20Beta%20Waitlist" class="inline-flex items-center rounded-xl bg-white/95 px-4 py-2 font-medium text-slate-900 hover:bg-white transition shadow-soft">Join Beta</a>
      </nav>
      <button aria-label="Open Menu" class="md:hidden p-2 rounded-lg hover:bg-white/10" onclick="document.getElementById('mnav').classList.toggle('hidden')">☰</button>
    </div>
    <div id="mnav" class="md:hidden hidden border-t border-white/10">
      <div class="container mx-auto px-4 py-3 space-y-2 text-slate-300">
        <a href="index.html" class="block">Home</a>
        <a href="products.html" class="block">Products</a>
        <a href="roadmap.html" class="block">Roadmap</a>
        <a href="projects.html" class="block">Projects</a>
        <a href="adn.html" class="block">For ADN Reviewers</a>
        <a href="about.html" class="block">About</a>
        <a href="contact.html" class="block">Contact</a>
        <a href="mailto:weber@bimopsstudio.com?subject=ReviTask%20Beta%20Waitlist" class="inline-flex items-center rounded-xl bg-white/95 px-4 py-2 font-medium text-slate-900">Join Beta</a>
      </div>
    </div>
  </header>

  <section class="container mx-auto px-4 py-16">
    <h1 class="text-3xl md:text-4xl font-bold">Products</h1>
    <p class="mt-3 text-slate-300 max-w-3xl">We’re building focused tools that work inside Revit to automate documentation, enforce standards, and reduce coordination risk.</p>

    <div class="mt-10 grid md:grid-cols-2 gap-6">
      <article class="rounded-2xl border border-white/10 bg-slate-900/50 p-6 shadow-soft">
        <h2 class="text-xl font-semibold">ReviTask</h2>
        <p class="mt-2 text-slate-300">An AI‑enhanced dashboard that automates Revit documentation.</p>
        <ul class="mt-4 space-y-2 text-slate-300 list-disc pl-5">
          <li>Batch sheet creation with title‑block control</li>
          <li>Smart view placement & 3D/section/elevation generation</li>
          <li>Automatic dimensioning, tagging, and notes</li>
          <li>IBC/FBC code‑check helpers and QC lists</li>
          <li>PDF/DWG export with naming rules</li>
        </ul>
        <div class="mt-5">
          <a class="text-sky-400 hover:underline" href="mailto:weber@bimopsstudio.com?subject=ReviTask%20Beta%20Access">Request beta access →</a>
        </div>
      </article>

      <article class="rounded-2xl border border-white/10 bg-slate-900/50 p-6 shadow-soft">
        <h2 class="text-xl font-semibold">SmartSheetList</h2>
        <p class="mt-2 text-slate-300">Precision sheet & detail management for Revit power users.</p>
        <ul class="mt-4 space-y-2 text-slate-300 list-disc pl-5">
          <li>Preview drafting/detail views from libraries</li>
          <li>Load selected details into the active model</li>
          <li>Batch operations with version tracking</li>
          <li>Company standards enforcement</li>
        </ul>
        <div class="mt-5">
          <a class="text-sky-400 hover:underline" href="mailto:weber@bimopsstudio.com?subject=SmartSheetList%20Inquiry">Ask about SmartSheetList →</a>
        </div>
      </article>
    </div>

    <h2 class="text-2xl font-semibold mt-12 mb-6">Free Tools</h2>
    
    <div class="grid md:grid-cols-2 gap-6">
      <article class="rounded-2xl border border-white/10 bg-slate-900/50 p-6 shadow-soft">
        <h2 class="text-xl font-semibold">View Preview Tool</h2>
        <div class="flex items-center justify-between mt-1">
          <span class="text-sm text-slate-400">v1.1 • Free</span>
          <div class="flex items-center gap-2 bg-sky-500/10 px-3 py-1 rounded-full">
            <span class="text-sm text-slate-300">Downloads:</span>
            <span id="downloadCounter" class="text-sm font-bold text-sky-400">0</span>
          </div>
        </div>
        <!-- Initialize counter immediately -->
        <script>
          (function() {
            const count = localStorage.getItem('vpt_download_count') || '0';
            const counter = document.getElementById('downloadCounter');
            if (counter) counter.textContent = count;
          })();
        </script>
        <details class="mt-2">
          <summary class="text-xs text-slate-400 cursor-pointer hover:text-slate-300">View download stats</summary>
          <div id="downloadStats" class="mt-2 p-3 bg-slate-800/50 rounded-lg text-xs space-y-2">
            <div id="regionList" class="space-y-1"></div>
          </div>
        </details>
        <p class="mt-2 text-slate-300">Instantly preview Revit views with a single click.</p>
        <ul class="mt-4 space-y-2 text-slate-300 list-disc pl-5">
          <li>Click-based preview system</li>
          <li>High-quality view thumbnails</li>
          <li>Smart window positioning</li>
          <li>Zoom and pan functionality</li>
          <li>Professional 700x800 preview window</li>
        </ul>
        <div class="mt-5 space-y-2">
          <p class="text-sm text-slate-400">Available for:</p>
          <div class="flex gap-3 flex-wrap">
            <button onclick="showDownloadForm('downloads/ViewPreviewTool_v1.0_Setup_2024.exe', 'Revit 2024')" class="text-sky-400 hover:underline text-sm">Revit 2024 (v1.0) →</button>
            <button onclick="showDownloadForm('downloads/ViewPreviewTool_v1.1_Setup.exe', 'Revit 2025/2026')" class="text-sky-400 hover:underline text-sm">Revit 2025/2026 (v1.1) →</button>
          </div>
        </div>
      </article>
    </div>

    <div class="mt-12">
      <a class="text-sky-400 hover:underline" href="adn.html">See details for ADN reviewers →</a>
    </div>
  </section>

  <!-- Download Form Modal -->
  <div id="downloadModal" class="fixed inset-0 bg-black/70 hidden items-center justify-center z-50" style="display: none;">
    <div class="bg-slate-900 rounded-2xl p-8 max-w-md w-full mx-4 shadow-soft border border-white/10">
      <h3 class="text-xl font-semibold mb-4">Download View Preview Tool</h3>
      <p class="text-slate-300 mb-6">Please provide your information to download.</p>
      <form id="downloadForm" onsubmit="handleDownload(event)">
        <div class="space-y-4">
          <div>
            <label class="block text-sm font-medium mb-2">Name</label>
            <input type="text" name="name" required class="w-full px-4 py-2 bg-slate-800 border border-white/10 rounded-lg focus:outline-none focus:border-sky-500">
          </div>
          <div>
            <label class="block text-sm font-medium mb-2">Email</label>
            <input type="email" name="email" required class="w-full px-4 py-2 bg-slate-800 border border-white/10 rounded-lg focus:outline-none focus:border-sky-500">
          </div>
          <div>
            <label class="block text-sm font-medium mb-2">Company (Optional)</label>
            <input type="text" name="company" class="w-full px-4 py-2 bg-slate-800 border border-white/10 rounded-lg focus:outline-none focus:border-sky-500">
          </div>
        </div>
        <div class="mt-6 flex gap-3">
          <button type="submit" class="flex-1 bg-sky-500 hover:bg-sky-600 text-white font-medium py-2 px-4 rounded-lg transition">Download</button>
          <button type="button" onclick="closeDownloadForm()" class="flex-1 bg-slate-700 hover:bg-slate-600 text-white font-medium py-2 px-4 rounded-lg transition">Cancel</button>
        </div>
      </form>
    </div>
  </div>

  <script>
    let downloadUrl = '';
    let downloadVersion = '';

    // Initialize download counter from localStorage
    function initDownloadCounter() {
      const count = localStorage.getItem('vpt_download_count') || '0';
      const counterElement = document.getElementById('downloadCounter');
      if (counterElement) {
        counterElement.textContent = count;
      } else {
        // Retry after a short delay if element not found
        setTimeout(() => {
          const counter = document.getElementById('downloadCounter');
          if (counter) counter.textContent = count;
        }, 100);
      }
    }

    // Get user timezone as proxy for location
    function getUserLocation() {
      const timezone = Intl.DateTimeFormat().resolvedOptions().timeZone;
      const locale = navigator.language || 'en-US';
      
      // Simple timezone to region mapping
      const timezoneRegions = {
        'America/New_York': 'Eastern US',
        'America/Chicago': 'Central US',
        'America/Denver': 'Mountain US',
        'America/Los_Angeles': 'Pacific US',
        'America/Phoenix': 'Arizona, US',
        'America/Anchorage': 'Alaska, US',
        'Pacific/Honolulu': 'Hawaii, US',
        'Europe/London': 'United Kingdom',
        'Europe/Paris': 'France',
        'Europe/Berlin': 'Germany',
        'Asia/Tokyo': 'Japan',
        'Asia/Shanghai': 'China',
        'Australia/Sydney': 'Australia',
        'America/Toronto': 'Canada',
        'America/Mexico_City': 'Mexico',
        'America/Sao_Paulo': 'Brazil',
        'Asia/Kolkata': 'India',
        'Asia/Dubai': 'UAE',
        'Africa/Johannesburg': 'South Africa'
      };
      
      const region = timezoneRegions[timezone] || timezone.split('/').pop().replace(/_/g, ' ');
      
      return {
        region: region,
        timezone: timezone,
        locale: locale
      };
    }

    function showDownloadForm(url, version) {
      downloadUrl = url;
      downloadVersion = version;
      document.getElementById('downloadModal').style.display = 'flex';
    }

    function closeDownloadForm() {
      document.getElementById('downloadModal').style.display = 'none';
      document.getElementById('downloadForm').reset();
    }

    function handleDownload(event) {
      event.preventDefault();
      const formData = new FormData(event.target);
      const data = Object.fromEntries(formData);
      
      // Get location data
      const location = getUserLocation();
      
      // Update download counter
      let count = parseInt(localStorage.getItem('vpt_download_count') || '0');
      count++;
      localStorage.setItem('vpt_download_count', count.toString());
      document.getElementById('downloadCounter').textContent = count;
      
      // Create download record
      const downloadRecord = {
        ...data,
        tool: 'View Preview Tool',
        version: downloadVersion,
        timestamp: new Date().toISOString(),
        location: location,
        userAgent: navigator.userAgent
      };
      
      // Store download history (keep last 1000 records)
      let history = JSON.parse(localStorage.getItem('vpt_download_history') || '[]');
      history.push(downloadRecord);
      if (history.length > 1000) {
        history = history.slice(-1000);
      }
      localStorage.setItem('vpt_download_history', JSON.stringify(history));
      
      // Log for debugging
      console.log('Download recorded:', downloadRecord);
      
      // Send to analytics endpoint (for future implementation)
      // In production, you'd send this to a backend service
      try {
        // Example: await fetch('/api/track-download', { method: 'POST', body: JSON.stringify(downloadRecord) });
      } catch (error) {
        // Silently fail analytics
      }
      
      // Create download link
      const a = document.createElement('a');
      a.href = downloadUrl;
      a.download = downloadUrl.split('/').pop();
      document.body.appendChild(a);
      a.click();
      document.body.removeChild(a);
      
      // Close form
      closeDownloadForm();
      
      // Update stats display
      updateDownloadStats();
      
      // Show success message
      alert('Thank you! Your download will begin shortly.');
    }

    // Update download stats display
    function updateDownloadStats() {
      const history = JSON.parse(localStorage.getItem('vpt_download_history') || '[]');
      
      // Count by region
      const regionCounts = {};
      history.forEach(d => {
        const region = d.location?.region || 'Unknown';
        regionCounts[region] = (regionCounts[region] || 0) + 1;
      });
      
      // Display top regions
      const regionList = document.getElementById('regionList');
      if (regionList) {
        regionList.innerHTML = '<div class="font-semibold mb-1">Downloads by Region:</div>';
        Object.entries(regionCounts)
          .sort((a, b) => b[1] - a[1])
          .slice(0, 5)
          .forEach(([region, count]) => {
            const div = document.createElement('div');
            div.className = 'flex justify-between';
            div.innerHTML = `<span>${region}</span><span class="font-bold">${count}</span>`;
            regionList.appendChild(div);
          });
        
        // Add recent downloads
        if (history.length > 0) {
          const recentDiv = document.createElement('div');
          recentDiv.className = 'mt-2 pt-2 border-t border-white/10';
          recentDiv.innerHTML = '<div class="font-semibold mb-1">Recent Downloads:</div>';
          
          history.slice(-3).reverse().forEach(d => {
            const downloadDiv = document.createElement('div');
            downloadDiv.className = 'text-slate-400';
            const time = new Date(d.timestamp).toLocaleDateString();
            downloadDiv.textContent = `${d.name} (${d.location?.region || 'Unknown'}) - ${time}`;
            recentDiv.appendChild(downloadDiv);
          });
          
          regionList.appendChild(recentDiv);
        }
      }
    }
    
    // Initialize on page load
    document.addEventListener('DOMContentLoaded', function() {
      initDownloadCounter();
      updateDownloadStats();
    });
  </script>

  <footer class="border-t border-white/10 mt-16">
    <div class="container mx-auto px-4 py-10 text-sm text-slate-400 flex flex-col md:flex-row items-start md:items-center justify-between gap-3">
      <p>© 2025 BIM Ops Studio • Idaho, USA</p>
      <p>Built with the Autodesk Revit API in mind • Privacy‑first</p>
    </div>
  </footer>
</body>
</html>
